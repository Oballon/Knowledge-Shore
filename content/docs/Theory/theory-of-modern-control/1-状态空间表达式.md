# 状态空间表达式

## 考情分析

线性系统离散化不考

## 连续、离散系统的表达式

$$连续：\begin{array}{l}
\dot{x} =Ax + Bu \\
y=Cx+Du
\end{array}（系统矩阵A为方阵）$$
$$离散：\begin{array}{l}
x(k+1) =Gx(k) +Hu(k)\\
y(k)=Cx(k)+Du(k)
\end{array}\\
$$

## 连续系统与离散系统对比

**总括衍生，离散系统考查较弱**
$$离散系统与连续系统诸多性质极其相似：
$$
$$\left.\begin{array}{}系统实现相通\\
非奇异变换相通
\end{array}\right\}
“积分元”\frac{1}{s}对应“延迟元”z^{-1}(T) \quad \#\quad \frac{\frac{1}{s}}{1+\frac{\lambda}{s}}对应\frac{\frac{1}{z}}{1+\frac{\lambda}{z}} $$
$$\mathscr{L}变换对应Z变换$$
$$传递函数阵计算公式（零初始条件）：\\
\left\{\begin{array}{l}
sX(s) =AX(s)+ BU(s) \\
Y(s)=CX(s)
\end{array}\right.\Rightarrow Y(s)=C(sI-A)^{-1}BU(z)\\
\ \\
\left\{\begin{array}{l}
zX(z)=GX(z)+HU(z)\\
Y(z)=CX(z)
\end{array}\right.\Rightarrow Y(z)=C(zI-G)^{-1}HU(z)\\
 注：根据状态空间表达式，计算离散、连续传递函数仅字母有异$$

## 非奇异变换及其性质

$$状态空间表达式非唯一，线性变换系统等价\\
连续：\left\{
\begin{array}{l}
\dot{x}=Ax+Bu\\
y=Cx+Du
\end{array}
\right.\xrightarrow{x=Tz,\quad z=T^{-1}x}
\left\{
\begin{array}{l}
\dot{z}=T^{-1}ATz+T^{-1}Bu\\
y=CTz+Du
\end{array}
\right.
$$
$$性质：\\
不改变系统传递函数阵\\
不改变特征方程、特征值\\
不改变能控、能观性
$$

## SISO能控标准Ⅰ型实现

**离散系统实现同理**
$${\color{blue}分母为首“1”型}\\
W(s)=\frac{b_ns^n+b_{n-1}s^{n-1}+\cdots+b_1s+b_0}{s^n+a_{n-1}s^{n-1}+\cdots+a_1s+a_0}=b_n+\frac{(b_{n-1}-a_{n-1}b_n)s^{n-1}+\cdots+(b_1-a_1b_n)s+(b_0-a_0b_n)}{s^n+a_{n-1}s^{n-1}
+\cdots+a_1s+a_0}\\
友矩阵：
A=
\begin{pmatrix}
  0&1&0&\cdots&0 \\
  0&0&1&\cdots&0 \\
\vdots&\vdots&\vdots&\ddots&\vdots \\
 0&0&0&\cdots&1 \\
  -a_0&-a_1&-a_2&\cdots &-a_{n-1}
\end{pmatrix}\qquad
b=\begin{pmatrix}
0\\
0\\
\vdots \\
0 \\
1
\end{pmatrix}\\
\ \\
c=((b_0-a_0b_n),(b_1-a_1b_n),\cdots,(b_{n-1}-a_{n-1}b_n))\qquad d=b_n$$
$$注：连续、离散系统传递函数实现一致\\
若分子阶次低于分母，则c仅由b_0,b_1,\cdots,b_{n-1}顺序构成
$$

## SISO能观标准Ⅰ型实现

**离散系统实现同理**
$$W(s)=\frac{b_ns^n+b_{n-1}s^{n-1}+\cdots+b_1s+b_0}{s^n+a_{n-1}s^{n-1}+\cdots+a_1s+a_0}\\
友矩阵：
A=
\begin{pmatrix}
  0&1&0&\cdots&0 \\
  0&0&1&\cdots&0 \\
\vdots&\vdots&\vdots&\ddots&\vdots \\
 0&0&0&\cdots&1 \\
  -a_0&-a_1&-a_2&\cdots &-a_{n-1}
\end{pmatrix}\qquad
b=\begin{pmatrix}
\beta_{n-1}\\
\beta_{n-2}\\
\vdots \\
\beta_1\\
\beta_0
\end{pmatrix}\\
\ \\
c=(1,0,\cdots,0,0)\qquad d=\beta_n\\
\ \\
\begin{pmatrix}
  1 \\
  a_{n-1}&1&&\text{{\huge 0}} \\
  a_{n-2}&a_{n-1}&1\\
  \vdots&\vdots&\ddots&\ddots \\
  a_0&a_1&\cdots &a_{n-1}&1
\end{pmatrix}
\begin{pmatrix}
\beta_n\\
\beta_{n-1}\\
\beta_{n-2}\\
\vdots \\
\beta_0
\end{pmatrix}=
\begin{pmatrix}{}
b_n\\
b_{n-1}\\
b_{n-2}\\
\vdots\\
b_0
\end{pmatrix}\qquad （按行计算，一般不超三阶）$$
$$注：连续、离散系统传递函数实现一致\\
能观标准Ⅰ型实现的计算矩阵为n+1维；能观标准Ⅰ型的变换矩阵为n维
$$

## MIMO系统能控、能观标准型实现

$$W(s)=\boldsymbol\beta_n+\frac{\boldsymbol\beta_{n-1}s^{n-1}+\boldsymbol\beta_{n-2}s^{n-2}+\cdots+\boldsymbol\beta_1s+\boldsymbol\beta_0}{s^n+a_{n-1}s^{n-1}+\cdots+a_1s+a_0}\quad （\beta_n提取与\text{SISO}方式一致）\\
\boldsymbol\beta_{n-1},\boldsymbol\beta_{n-2},\cdots,\boldsymbol\beta_1,\boldsymbol\beta_0为m\times r为矩阵，m为输出矢量的维数，r为输入矢量的维数$$
$$能控标准Ⅰ型：\\
A=
\begin{pmatrix}
\mathbf{0}_r&\textbf{I}_r&\mathbf{0}_r&\cdots&\mathbf{0}_r \\
\mathbf{0}_r&\mathbf{0}_r&\textbf{I}_r&\cdots&\mathbf{0}_r \\
\vdots&\vdots&\vdots&\ddots&\vdots \\
\mathbf{0}_r&\mathbf{0}_r&\mathbf{0}_r&\cdots&\textbf{I}_r \\
  -a_0\textbf{I}_r&-a_1\textbf{I}_r&-a_2\textbf{I}_r&\cdots &-a_{n-1}\textbf{I}_r
\end{pmatrix}\qquad
B=\begin{pmatrix}
\mathbf{0}_r\\
\mathbf{0}_r\\
\vdots \\
\mathbf{0}_r \\
\textbf{I}_r
\end{pmatrix}\\
\ \\
C=(\boldsymbol\beta_0,\boldsymbol\beta_1,\cdots,\boldsymbol\beta_{n-1})\quad D=\boldsymbol\beta_n$$
$$能观标准Ⅱ型：\\
A=
\begin{pmatrix}
\mathbf{0}_m&\mathbf{0}_m&\cdots&\mathbf{0}_m&  -a_0\textbf{I}_m\\
\textbf{I}_m&\mathbf{0}_m&\cdots&\mathbf{0}_m&-a_1\textbf{I}_m \\
\mathbf{0}_m&\textbf{I}_m&\cdots&\mathbf{0}_m &-a_2\textbf{I}_m\\
\vdots&\vdots&\ddots&\vdots &\vdots\\
\mathbf{0}_m&\mathbf{0}_m&\cdots&\textbf{I}_m &-a_{n-1}\textbf{I}_m\\
\end{pmatrix}\qquad
B=\begin{pmatrix}
\boldsymbol\beta_0\\
\boldsymbol\beta_1\\
\boldsymbol\beta_2\\
\vdots\\
\boldsymbol\beta_{n-1}
\end{pmatrix}\\
\ \\
C=(\mathbf{0}_m,
\mathbf{0}_m,
\cdots ,
\mathbf{0}_m,
\textbf{I}_m)\quad D=\boldsymbol\beta_n$$
$$注：能控标准Ⅰ型与能观标准Ⅱ型不是简单转置关系$$

## 约旦标准型实现

**离散系统实现同理**
$$思路：传递函数因式分解$$
$$单根：G(s)=\frac{a}{s-\lambda_1}+\frac{b}{s-\lambda_2}+\frac{c}{s-\lambda_3}+\cdots\\
A=
\left(\begin{array}{l}
\lambda_1\\
&\lambda_2\\
&&\lambda_3
\end{array}\right)\quad

b=
\left(\begin{array}{l}
1\\
1\\
1
\end{array}\right)\\
\ c=
\left(\begin{array}{l}
a & b & c
\end{array}\right)\\
或A=
\left(\begin{array}{l}
\lambda_1\\
&\lambda_2\\
&&\lambda_3
\end{array}\right)\quad b=
\left(\begin{array}{l}
a\\
b\\
c
\end{array}\right)\\
\ c=
\left(\begin{array}{l}
1 & 1 & 1
\end{array}\right)$$
$$重根：G(s)=\frac{a}{(s-\lambda_1)^3}+\frac{b}{(s-\lambda_1)^2}+\frac{c}{(s-\lambda_1)}\\
A=
\left(\begin{array}{l}
\lambda_1&1\\
&\lambda_1&1\\
&&\lambda_1
\end{array}\right)\quad

b=
\left(\begin{array}{l}
0\\
0\\
1
\end{array}\right)\\
\ c=
\left(\begin{array}{l}
a&b&c
\end{array}\right)$$
$$注：同时含有单根、复根，矩阵拼接即可\\
{\color{blue}只考查输入一维系统}$$

## 约旦标准型

$$定义：除了主对角线和主对角线上方元素之外，其余都是零\\主对角线上方的对角线的系数若不为0只能为1，且这1左方和下方的系数（都在主对角线上）有相同的值\\
\ \\
即\quad约旦标准型的对角元素为矩阵特征值\lambda_i，紧邻对角线的上方元素为0或1，其余元素均为0$$
$$性质：\\
1.任何矩阵均可约旦对角化\\
2.约旦标准型中，重特征值有可能对应多个子约旦块（此类矩阵不考）\\
{\color{blue}某重特征值对应的几何重数=此特征向量对应的子约旦块个数}\\
例：
\left(
\begin{array}{}
3 & 1 & -1\\
-2 & 0 & 2 \\
-1 & -1 & 3
\end{array}
\right)\quad
\lambda_1=\lambda_2=\lambda_3=2\\
A的约旦标准型为\left(
\begin{array}{}
2 &0&0\\
0 & 2 & 1 \\
0 & 0 & 2
\end{array}
\right)$$

## 约旦标准型的变换阵

$$单特征值：求特征矢量即可\\
x=Tz\qquad T=(P_1,P_2,\dots, P_n)$$
$$重特征值(单根部分用单根方法求)：\\
此法由“单一标准型”反推得，仅可求重特征值仅对应一个约旦块情形\\
\lambda_1P_1-AP_1=0\qquad {\color{blue}（P_1只能是一维特征向量，即几何重数为1）}\\
\lambda_1P_2-AP_2=-P_1\\
\qquad\qquad\ \vdots\\
\lambda_1P_q-AP_q=-P_{q-1}\\
$$
$$注：
对角线标准型即为特征根均互异的约旦标准型$$

## 传递函数阵及其性质

**离散系统同理**
$$传递函数阵：\left\{\begin{array}{ll}
W_{ux}(s)=\frac{X(s)}{U(s)}=(sI-A)^{-1}b & W_{ux}(s)=\frac{X(s)}{U(s)}=(sI-A)^{-1}B\\
\ \\
W(s)=\frac{Y(s)}{U(s)}=c(sI-A)^{-1}b+d & W(s)=\frac{Y(s)}{U(s)}=C(sI-A)^{-1}B+D

\end{array}\right.$$
$$子系统组合的传递函数阵：\\
并联连接：W(s)=W_1(s)\pm W_2(s)\\
串联连接：W(s)=W_2(s) W_1(s)\quad （注意次序，“后”乘“前”；\quad 输入、输出维数对应）\\
负反馈连接：
\left\{\begin{array}{}
W(s)=W_1(s)[I+W_2(s)W_1(s)]^{-1}\\
W(s)=[I+W_1(s)W_2(s)]^{-1}W_1(s)
\end{array}\right.\quad （注意次序\quad 1,2,1；\quad  W_1(s)，W_2(s)维数对偶）$$

## 模拟结构图绘制典例

$$\left.\begin{array}{l}
能控标准型\\
能观标准型
\end{array}\right\}关键在系统的友矩阵绘制，
\left\{\begin{array}{}
A(x_n\to x_1\ +\  “归首”)\\
A^T(x_1\to x_n\ +\  “尾散”)
\end{array}\right.b,c直接引出即可$$
$$约旦标准型：\\
系统矩阵绘制
\left\{\begin{array}{l}
单根：独立\\
重根：x_n\to x_1\  +\ “元回路”
\end{array}\right.\quad
正反馈系数对应特征值\lambda；\quad
b,c直接引出即可$$
$$一般结构图：关键在确定状态变量先后关系（最多三阶，考查不会复杂）$$

## 状态变量选取及状态空间表达式建立

**整理思路：列写所有变量关系，消去中间变量**
$$一阶环节
\frac{1}{s},\quad\frac{s-1}{s+2},\quad \frac{3}{0.5s+1}\\
每个一阶环节后对应一个状态变量\\
变量间关系“去分式”后对应：\\
X_2=\frac{s-1}{s+2}X_1\\
X_2(s+2)=(s-1)X_1\longrightarrow \dot{x}_2+2x_2=\dot{x}_1-x_1\\
等式整理合并为
\left\{\begin{array}{l}
\dot{x}=Ax+bu\\
y=cx
\end{array}\right.变量对应绘制模拟结构图即可$$
$$注：线性系统均可消元整理出来$$

## 约旦标准化（对角化）题型

**各有特点，灵活运用**
$$系统实现：求出传递函数G(s)=c(sI-A)^{-1}b\\
因式分解(\frac{a}{s-\lambda_1}+\frac{b}{s-\lambda_2}+\cdots)，利用约旦标准型实现进行标准化\\
$$

$$约旦变换：计算变换矩阵x=Tz进行线性变换\\
\overline{A}=T^{-1}AT \quad
\overline{b}=T^{-1}b\quad
\overline{c}=cT$$
