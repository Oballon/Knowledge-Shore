
# ""能控性能观性""

## 能控、能观性定义

$$u(t)对状态矢量x(t)的控制性（对任意状态均能控，则系统能控）：\\
存在一个分段连续的输入u(t)，能在有限时间区间内，使系统由某一初始状态x(t_0)，转移至指定的任意终端状态x(t)$$
$$y(t)对状态矢量x(t)的观测性（对任意状态均能观，则系统能观）：\\
对任意给定的u，在有限观测时间内t_f>t_0，使得根据[t_0,t_f]期间的输出y(t)能唯一地确定系统在初始时刻的状态x(t_0)\\
$$

## 离散化对系统性能影响

$$
1. 能控或能观的连续系统，离散化后不一定能保持其能控或能观性\\
2. 不能控或不能观的系统，无论采样周期如何选择，离散化后一定不能控或不能观$$

## 能控、能观的判定方法

$$是否友矩阵标准型（四类）\\
\ \\
约旦标准型判据（记，勿深究）\\
\ \\
能控、能观判别矩阵行、列满秩（核心）\\
\ \\
\text{SISO}系统c(sI-A)^{-1}b，(sI-A)^{-1}b是否零极点对消
$$

## 友矩阵标准型判定

$$系统矩阵A为友矩阵或其转置，对应b,c也应为标准型\\
观测量，控制量多了不一定能控、能观$$

## 能控性、能观性判别矩阵

$$行满秩即能控：\\
M=(b, Ab, A^2b, \cdots, A^{n-1}b)\\
M=(B, AB, A^2B, \cdots, A^{n-1}B)\\
M=(H, GH, G^2H, \cdots, G^{n-1}H)$$
$$列满秩即能观：\\
N=\begin{pmatrix}
  c \\
 cA \\
\vdots \\
 cA^{n-1}
\end{pmatrix}\quad N=\begin{pmatrix}
  C \\
 CA \\
\vdots \\
 CA^{n-1}
\end{pmatrix}\quad
N=\begin{pmatrix}
  C \\
 CG \\
\vdots \\
 CG^{n-1}
\end{pmatrix}$$

## 约旦标准型判断能控、能观

**结论可能存在问题，建议用判别矩阵**
$$能控性：\\
互异特征值：每个特征值对应的B阵的各行元素均不全为0，{\color{grey}且线性无关}\\
相同特征值：对于某重特征值，属于该特征值的各子约旦块的最后一行所对应的B的行均不全为0，且线性无关\\
\ \\
能观性：\\
互异特征值：每个特征值对应的C阵的各列元素均不全为0\\
相同特征值：对于某重特征值，属于该特征值的各子约旦块的首列所对应的C的列均不全为0，且线性无关
$$
$$注：零向量与其本身线性相关，零向量与任何向量线性相关\\
重特征值多个约旦块，B为单列（或C为单行），必线性相关$$

## 输出能控性判别矩阵

$$u(t)对y(t)的能控性\\\\
行满秩即能控：
M=(CB,CAB,CA^2B,\cdots,CA^{n-1}B,D)$$

## 零极点对消

$$W(s)=c(sI-A)^{-1}b\\
 (sI-A)^{-1}=\frac{(sI-A)^*}{|sI-A|}
\left\{
\begin{array}{l}
若无零极点对消，分母为s的n阶多项式\\
若存在零极点对消，分母阶次小于n
\end{array}
\right.$$

## 能控、能观的充分必要条件

$$\Sigma(A,B,C)为最小实现\Leftrightarrow 系统能控且能观\\
\ \\
单输入系统\Sigma(A,b,c)能控的充分必要条件：\\
W_{ux}=(sI-A)^{-1}b\ 无零极点对消\\
\ \\
单输入单输出系统\Sigma(A,b,c)能控能观的充分必要条件：\\
W(s)=c(sI-A)^{-1}b\ 无零极点对消$$
$$注：多输入多输出系统C(sI-A)^{-1}B无零极点对消\ \substack{\Rightarrow\\
\not\Leftarrow}\ 系统\Sigma(A,B,C)能控能观（最小实现）$$

## 最小实现部分

$$寻找系统\Sigma(A,B,C)最小实现的方法：找出完全能控且能观的部分$$

## 系统的对偶关系与性质

$$系统\Sigma_1\left\{\begin{array}{l}
\dot{x_1}=A_1x_1+B_1u_1\\
y_1=C_1x_1
\end{array}{}
\right.\qquad
系统\Sigma_2\left\{\begin{array}{l}
\dot{x_2}=A_2x_2+B_2u_2\\
y_2=C_2x_2
\end{array}{}
\right.\\
\ \\
系统\Sigma_1与\Sigma_2互为对偶:
A_2=A_1^T\qquad
B_2=C_1^T\qquad
C_2=B_1^T$$
$$性质：\\
对偶系统的传递函数矩阵互为转置\\
\Sigma_1的能控性（能观性）等价于\Sigma_2的能观性（能控性）$$

## 能控标准Ⅰ型与能观标准Ⅱ型

**前提：判定系统能控、能观**

$$\begin{array}{ll}
能控标准Ⅰ型：&能观标准Ⅱ型：\\
\overline{A}=T^{-1}_{c1}AT_{c1}=
\begin{pmatrix}
  0&1&\cdots&0&0 \\
  0&0&\cdots&0&0 \\
  \vdots&\vdots&&\vdots&\vdots \\
 0&0&\cdots&0&1 \\
  -a_0&-a_1&\cdots &-a_{n-2}&-a_{n-1}
\end{pmatrix}
&
\overline{A}=T^{-1}_{o2}AT_{o2}=
\begin{pmatrix}
  0&0&\cdots&0&-a_0 \\
  1&0&\cdots&0&-a_1 \\
 0&1&\cdots&0&-a_2 \\
  \vdots&\vdots&&\vdots&\vdots \\
  0&0&\cdots &1&-a_{n-1}
\end{pmatrix}\\

\overline{b}=T^{-1}_{c1}b=
\begin{pmatrix}
0\\
0\\
\vdots \\
0 \\
1
\end{pmatrix}
&
\overline{b}=T^{-1}_{o2}b=
\begin{pmatrix}
\beta_0\\ \beta_1\\ \beta_2\\ \vdots\\ \beta_{n-1}
\end{pmatrix}
\\

\overline{c}=cT_{c1}=(\beta_0, \beta_1, \beta_2, \cdots, \beta_{n-1})
&
\overline{c}=cT_{o2}=(0, 0, 0, \cdots, 1)\\

\ \\
T_{c1}=(A^{n-1}b, A^{n-2}b, \dots, Ab, b)
\begin{pmatrix}
  1 \\
  a_{n-1}&1&&\text{{\huge 0}} \\
  \vdots&\vdots&\ddots \\
  a_2&a_3&\cdots&1 \\
  a_1&a_2&\cdots &a_{n-1}&1
\end{pmatrix}
&
T_{o2}^{-1}=
\begin{pmatrix}
  1&a_{n-1}&\cdots&a_2&a_1\\
  &1&\cdots&a_3&a_2 \\  &&\ddots&\vdots&\vdots \\
  &\text{{\huge 0}}&&1&a_{n-1} \\
  &&&&1
\end{pmatrix}
\begin{pmatrix}
cA^{n-1}\\
 cA^{n-2}\\
\vdots\\
 cA\\
 c
\end{pmatrix}

\end{array}$$
$$标准化步骤：
\left\{\begin{array}{l}
1. 特征多项式|\lambda I-A|=0求得a_i\\
2. 计算变换矩阵T
\end{array}\right.$$
$$注：(cT_{c1})^T=T_{o2}^{-1}b\\
能观标准Ⅰ型实现的计算矩阵为n+1维\\
能控标准Ⅰ型的变换矩阵为n维$$


## 能观标准Ⅰ型与能控标准Ⅱ型

**前提：判定能控、能观**
$$\begin{array}{ll}
能观标准Ⅰ型：&能控标准Ⅱ型：\\
\overline{A}=T^{-1}_{o1}AT_{o1}=
\begin{pmatrix}
  0&1&\cdots&0&0 \\
  0&0&\cdots&0&0 \\
  \vdots&\vdots&&\vdots&\vdots \\
 0&0&\cdots&0&1 \\
  -a_0&-a_1&\cdots &-a_{n-2}&-a_{n-1}
\end{pmatrix}
&
\overline{A}=T^{-1}_{c2}AT_{c2}=
\begin{pmatrix}
  0&0&\cdots&0&-a_0 \\
  1&0&\cdots&0&-a_1 \\
 0&1&\cdots&0&-a_2 \\
  \vdots&\vdots&&\vdots&\vdots \\
  0&0&\cdots &1&-a_{n-1}
\end{pmatrix}\\

\overline{b}=T^{-1}_{o1}b=
\begin{pmatrix}
\beta_0\\ \beta_1\\ \beta_2\\ \vdots\\ \beta_{n-1}
\end{pmatrix}
&

\overline{b}=T^{-1}_{c2}b=
\begin{pmatrix}
1\\
0\\
\vdots \\
0 \\
0
\end{pmatrix}\\

\overline{c}=cT_{o1}=(1, 0, 0, \cdots, 0)&\overline{c}=cT_{c2}=(\beta_0, \beta_1, \beta_2, \cdots, \beta_{n-1})\\
\ \\

T_{o1}^{-1}=
\begin{pmatrix}
c\\
cA\\
\vdots\\
cA^{n-1}
\end{pmatrix}&
T_{c2}=(b, Ab, \cdots, A^{n-1}b)
\end{array}$$
$$注：(\overline{c})^T=\overline{b}，即(cT_{c2})^T=T_{o1}^{-1}b$$

## 能控、能观标准化题型

$$若仅求标准型，直接求W(s)，利用\text{SISO}系统实现更快捷（标准化的通用方法较繁琐）$$
$$注：能控、能观标准化的考查仅为\text{SISO}系统，且阶数\leqslant3$$

## 能控性、能观性分解

**能控、能观的分解与能观I型、能控Ⅱ型的标准化本质相似（较深不必深究）**
$$\begin{array}{ll}
能控性分解：&能观性分解：\\
标准形式：& 标准形式：\\

\widehat{A}=R^{-1}_c AR_c=
\begin{pmatrix}
\widehat{A}_{11} & \widehat{A}_{12} \\
\\
0 & \widehat{A}_{22}
\end{pmatrix}
&
\widehat{A}=R^{-1}_o AR_o=
\begin{pmatrix}
\widehat{A}_{11} & 0\\
\\
\widehat{A}_{21} & \widehat{A}_{22}
\end{pmatrix}\\

\widehat{B}=R^{-1}_{c}B=
\begin{pmatrix}
\widehat{B}_1 \\
\\
\hdashline \\
0
\end{pmatrix}
&
\widehat{B}=R^{-1}_0B=
\begin{pmatrix}
\widehat{B}_1 \\
\\
\hdashline \\
\widehat{B}_2
\end{pmatrix}\\

\widehat{C}=CR_c=
\left(
\begin{array}{c:c}
\widehat{C}_1 & \widehat{C}_2
\end{array}
\right)
&
\widehat{C}=CR_0=
\left(
\begin{array}{c:c}
\widehat{C}_1 &0
\end{array}
\right)\\
\ \\

变换矩阵：R_c=(R_1, R_2, \cdots, R_{n_c}, \cdots, R_n)
&
变换矩阵：R^{-1}_o=
\begin{pmatrix}
R_1\\
R_2\\
\vdots \\
R_{n_o} \\
\vdots \\
R_n
\end{pmatrix}\\
\begin{array}{l}
前n_c个列矢量是能控性判别阵M的n_c个线性无关的列\\
其余n-n_c个列矢量保证变换矩阵可逆即可
\end{array}
&
\begin{array}{l}
前n_o个行矢量是能观性判别阵N的n_o个线性无关的行\\
其余n-n_o个行矢量保证变换矩阵可逆即可
\end{array}\\
\ \\
\Sigma(\widehat{A}_{11},\widehat{B}_1,\widehat{C}_1)能控 \qquad{\color{blue}（能控子系统维数为n_c）}& \Sigma(\widehat{A}_{11},\widehat{B}_1,\widehat{C}_1)能观\qquad {\color{blue}（能观子系统维数为n_o）}
\end{array}$$

$$注：{\color{blue}涉及矩阵运算很多，R^{-1},R；考查不会超过三阶}\\
对角线上为子系统，A下标从后往前读表示输出方向$$

## 能控能观结构分解的标准形式

$$\widehat{A}=
\begin{pmatrix}
A_{11} & 0 & A_{13} & 0 \\
A_{21} & A_{22} & A_{23} & A_{24} \\
0 & 0 & A_{33} & 0 \\
0 & 0 & A_{43} &A_{44}
\end{pmatrix}\qquad

\widehat{B}=
\begin{pmatrix}
B_1 \\
B_2 \\
0 \\
0
\end{pmatrix}\\
\ \\
\widehat{C}=
\ \begin{pmatrix}
\ \ C_1\ &\ 0\ &\ \ C_3\ &\ \ 0\ \
\end{pmatrix}
$$
$$注：能控右上角，能观左下角$$

## 能控能观性结构分解

**能控、能观的分解与能观I型、能控Ⅱ型的标准化本质相似（较深不必深究）**
$$\Sigma(A,B,C)能控性分解x=R_c\left(\begin{array}{}x_c\\x_{\overline{c}}\end{array}\right)\\
\qquad
\begin{array}{rl}
\left(\begin{array}{}\dot{x}_c\\\dot{x}_{\overline{c}}\end{array}\right)=&R_c^{-1}AR_c\left(\begin{array}{}x_c\\x_{\overline{c}}\end{array}\right)+R^{-1}Bu
=\left(\begin{array}{}\overline{A}_1&\overline{A}_2\\
0&\overline{A}_4\\
\end{array}\right)
\left(\begin{array}{}x_c\\x_{\overline{c}}\end{array}\right)+
\left(\begin{array}{}
\overline{B}\\
0
\end{array}\right)u\\
\\
y=&CR_c\left(\begin{array}{}
x_c\\x_{\overline{c}}\end{array}\right)
=(\overline{C}_1,\overline{C}_2)\left(\begin{array}{}x_c\\x_{\overline{c}}\end{array}\right)

\end{array}$$
$$\begin{array}{}不能控子系统\Sigma_{\overline{c}}(\overline{A}_4,0,\overline{C}_2)能观性分解x_{\overline{c}}=
R_{02}\left(\begin{array}{}
x_{\overline{c}\ o}\\
x_{\overline{c}\ \overline{o}}
\end{array}\right)
&
能控子系统\Sigma_c(\overline{A}_1,\overline{B},\overline{C}_1)能观性分解
x_{c}=
R_{01}\left(\begin{array}{}
x_{c\ o}\\
x_{c\ \overline{o}}
\end{array}\right)\\
\ \\

\begin{array}{}
\dot{x_{\overline{c}}}=\overline{A}_4x_{\overline{c}}\\
\ \\
\begin{array}{rl}
\left(\begin{array}{}
\dot{x}_{\overline{c}\ o}\\
\dot{x}_{\overline{c}\ \overline{o}}
\end{array}\right)=&
R_{02}^{-1}\overline{A}_4R_{02}\left(\begin{array}{}
x_{\overline{c}\ o}\\
x_{\overline{c}\ \overline{o}}
\end{array}\right)\\
=&
\left(\begin{array}{}
A_{33}&0\\
A_{43}&A_{44}
\end{array}\right)
\left(\begin{array}{}
x_{\overline{c}\ o}\\
x_{\overline{c}\ \overline{o}}
\end{array}\right)
\end{array}\\
\ \\
y=\overline{C}_2R_{02}\left(\begin{array}{}
x_{\overline{c}\ o}\\
x_{\overline{c}\ \overline{o}}
\end{array}\right)=(C_3,0)\left(\begin{array}{}
x_{\overline{c}\ o}\\
x_{\overline{c}\ \overline{o}}
\end{array}\right)
\end{array}

&

\begin{array}{}

\dot{x}_c=\overline{A}_1x_c+\overline{A}_2x_{\overline{c}}+\overline{B}u\\
\ \\
\left(\begin{array}{}
\dot{x}_{c\ o}\\
\dot{x}_{c\ \overline{o}}
\end{array}\right)
=
R_{01}^{-1}\overline{A}_1R_{01}\left(\begin{array}{}
x_{c\ o}\\
x_{c\ \overline{o}}
\end{array}\right)+
R_{01}^{-1}\overline{A}_2R_{02}
\left(\begin{array}{}
x_{\overline{c}\ o}\\
x_{\overline{c}\ \overline{o}}
\end{array}\right)+R_{01}^{-1}\overline{B}u\\

=
\left(\begin{array}{}
A_{11}&0\\
A_{21}&A_{22}
\end{array}\right)x_c+
\left(\begin{array}{}
A_{13}&0\\
A_{23}&A_{24}
\end{array}\right)x_{\overline{c}}+
\left(\begin{array}{}
B_1\\
B_2
\end{array}\right)u\\
\ \\
y=\overline{C}_1R_{01}\left(\begin{array}{}x_{co}\\x_{c\overline{o}}\end{array}\right)=(C_1,0)\left(\begin{array}{}x_{co}\\x_{c\overline{o}}\end{array}\right)
\end{array}

\end{array}$$
$$注：{\color{blue}涉及矩阵运算多；考查不会超过三阶}\\
每一步判断能控、能观性\left\{\begin{array}{l}
能控或能观，相应不用分解\\
一维子系统无需分解，直接判断即可\\
非一维不能观子系统才需分解

\end{array}\right.$$

## 传递函数不同能控、能观性实现

<div style="text-align: center;">
<img src=pic-theory-of-modern-control\Markji_1751378200640.png width="90%">
</div>

$$可控不可观、可观不可控对应\frac{s+1}{s^2+3s+2}的可控、可观标准型实现即可$$
$$不可控不可观实现：\frac{Y(s)}{U(s)}=\frac{s+1}{(s+1)(s+2)}=\frac{0}{s+1}+\frac{1}{s+2}\\
不可控、不可观
\left\{\begin{array}{l}

A=
\left(\begin{array}{l}
-1\\&-2
\end{array}\right)\quad
b=
\left(\begin{array}{l}
0\\1
\end{array}\right)\\
\ c=(0\quad 1)

\end{array}\right.$$
$$对角线标准型可灵活构造可控不可观、可观不可控标准型：\\
可控、不可观
\left\{\begin{array}{l}

A=
\left(\begin{array}{l}
-1\\&-2
\end{array}\right)\quad
b=
\left(\begin{array}{l}
1\\1
\end{array}\right)\\
\ c=(0\quad 1)

\end{array}\right.\qquad 可观、不可控
\left\{\begin{array}{l}

A=
\left(\begin{array}{l}
-1\\&-2
\end{array}\right)\quad
b=
\left(\begin{array}{l}
0\\1
\end{array}\right)\\
\ c=(1\quad 1)

\end{array}\right.$$
