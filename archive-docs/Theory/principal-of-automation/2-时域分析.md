# 时域分析

## 时域尾“1”标准型

$$尾一型：G(s)=\frac{K(2s+1)(-3s+1)}{s^v(s+1)(-2s+1)(5s+1)}（便于计算稳态误差e_{ss}）\\
\ \\
开环增益、开环放大倍数K：
即尾“1”标准型下的比例系数，不一定是稳态增益(s^v\to0)$$

## 一阶系统单位阶跃响应

**图像重点记忆**

<div style="text-align: center;">
<img src="pic-principal-of-automation-control\Markji_1751374341709.jpg" width="40%">
</div>

$$\Phi(s)=\frac{1}{Ts+1}（时间常数T）\quad
c(t)=1-e^{-\frac{t}{T}}\\
t=T\quad c(t)=63.2\%\\
t=2T\quad c(t)=86.5\%\\
t=3T\quad c(t)=95\%\\
t=4T\quad c(t)=98.2\%\\
可能以响应暗示T$$
$$注：脉冲响应c(t)=\frac{1}{T}e^{-\frac{1}{T}t}$$

## 典型二阶系统

$$开环满足G(s)=\frac{b}{s(s+a)},且闭环系统为单位负反馈系统，则有\\
G(s)=\frac{\omega_n^2}{s(s+2\xi\omega_n)}\qquad
\Phi(s)=\frac{\omega_n^2}{s^2+2\xi\omega_ns+\omega_n^2}\\
\ \\
s_{1,2}=-\xi\omega_n\pm \sqrt{\xi^2-1}\ \omega_n
\left\{\begin{array}{ll}
\xi:&阻尼比\\
\omega_n:&无阻尼自然频率\\
\omega_d:& 有阻尼振荡频率(\omega_n\sqrt{1-\xi^2})（欠阻尼）
\end{array}\right.\\
\ \\
极点位置及阶跃响应曲线:\\
\xi=0（无阻尼）：两个虚根\quad s_{1,2}=\pm j\omega_n\\
0<\xi<1（欠阻尼）：两个不同的负复极点\quad s_{1,2}=-\xi\omega_n\pm j\sqrt{1-\xi^2}\omega_n\\
{\color{blue}注：\omega_n代表长度，\xi代表角度（以实部\xi\omega_n把握\beta大小）}\\
\xi=1（临界阻尼）：两个相同的负实极点\quad s_{1,2}=-\omega_n\\
\xi>1（过阻尼）：两个不同的负实极点\quad s_{1,2}=-\xi\omega_n\pm \sqrt{\xi^2-1}\omega_n\\
\xi<0（负阻尼）：两个正极点（略）$$
$$注：典型二阶系统传递函数，极点只可能同正、同负或同为零（一般二次方程无此特点）$$

## 二阶欠阻尼系统单位阶跃响应函数

$$h(t)=1-\frac{e^{-\xi \omega_n t}}{\sqrt{1-\xi^2}}\sin(\sqrt{1-\xi^2}\ \omega_nt+\beta)\quad
(\tan\beta=\frac{\sqrt{1-\xi^2}}{\xi})\quad 周期震荡曲线$$

## 不同输入下的系统响应间的关系

$$\begin{array}{ll}
&输入&输出\\
单位脉冲& r_{\delta}(t)=\delta(t) & c_{\delta}(t)=c'_p(t) \\
单位阶跃& r_p(t)=1(t) & c_p(t)=c'_v(t)\\
单位斜坡& r_v(t)=t & c_v(t)=c'_a(t)\\
单位加速度&r_a(t)=\frac{t^2}{2}&\cdots \\
\end{array}\\
针对同一系统，输入满足导数关系，输出间同样满足导数关系$$

## 动态性能指标

**含零点的动态性能公式不考**

$$t_p, \ \sigma\%,\  t_s,\ t_r$$

$$二阶欠阻尼系统极点：-\xi\omega_n\pm j\sqrt{1-\xi^2}\ \omega_n\quad (0<\xi<1)\\
实部:\xi\omega_n\quad 虚部：\sqrt{1-\xi^2}\ \omega_n\quad（
\xi影响角度，\omega_n影响长度）$$
$$t_p=\frac{\pi}{\sqrt{1-\xi^{2}}\omega_n} \qquad （峰值时间）$$
$$\sigma\%=e^{-\frac{\pi}{\tan\beta}} \times100\%=e^{-\frac{\xi}{\sqrt{1-\xi^2}}\pi}\times100\%\\
注：c_{\max}(t)=e_{ss}\cdot(1+\sigma\%)
$$
$$t_s=\frac{3.5}{\xi\omega_n}, \quad t_s=\frac{3}{\xi\omega_n} (\Delta=0.05) , \ t_s=\frac{4}{\xi\omega_n} (\Delta=0.02)  
$$
$$t_r=\frac{\pi-\beta}{\sqrt{1-\xi^2}\omega_n}\qquad （上升时间）$$

## 二阶系统动态性能与极点位置的关系

$$借助实部\xi \omega_n,虚部\sqrt{1-\xi^2}\omega_n,\beta(\beta=\arctan\frac{\sqrt{1-\xi^2}}{\xi})判断\\
t_p,t_s,\sigma\%由以上构成$$
$$工程最佳参数：\xi=\frac{\sqrt{2}}{2}=0.707\qquad \sigma\%=e^{-\pi}=4.3\%$$

## 稳定性定义

$$理论分析中：\\
\begin{array}{}
稳定 & 临界稳定 & 不稳定\\
“渐进稳定” & “随遇稳定” & “越偏越远”
\end{array}\\
\ \\
工程实践中：\\
闭环极点全部位于S平面的左半平面，系统稳定\\
只要右半平面，或虚轴上存在闭环极点，系统不稳定（临界稳定、不稳定）
$$
$$注：存在虚根\Leftrightarrow 临界稳定\Leftarrow 李雅普诺夫稳定（有界稳定）\\
等价于状态稳定：开环传递函数、闭环传函存在相同的零、极点一定不能消去$$

$${\color{grey}齐次连续线性时不变系统为临界稳定的充分必要条件是：}\\
{\color{grey}系统传递函数中每个极点的实部都为非正值，}\\
{\color{grey}且其中有一个或多个极点实部为零，}\\
{\color{grey}且均为相异的单根，}\\
{\color{grey}而其他的极点实部为负值}$$

## 稳定判定方法

**简单情形，解因式，判极点位置**
$$三阶以下首先考虑因式分解$$
**劳斯稳定判据**
$$闭环特征方程D(s)=a_ns^n+a_{n-1}s^{n-1}+\cdots+a_0\\
稳定要求（临界稳定视作不稳定）：\\
1. 各项系数 a_i>0或a_i<0 (i=0,1,2,\cdots)\\
2. 劳斯表第一列大于零且无虚根（虚根为临界稳定）\\
注：\ a_i\ne 0 （i=1,2,\cdots,n-1\quad n阶系统不缺中间项\quad a_0=0为临界稳定）\\
{\color{blue}特殊}：二阶系统各项系数均同号，即稳定
$$
$$劳斯表列法（行元素“隔阶”列写）：\\
\begin{array}{}
s^4 & 1 & 7 & 10 \\
s^3 & 5 & 2  \\
s^2 & \frac{5\times7-1\times2}{5} & \frac{5\times10-0}{5} \\
s^1 & \cdots \\
s^0 & \cdots
\end{array}\\
根的位置：\\
1.不稳定极点个数a=变号次数\\
2.特征方程纯虚根个数b=辅助方程纯虚根个数\\
3.稳定极点个数=方程阶数-a-b$$
$$注：{\color{blue}劳斯判别法姑且用即可，勿深究各类情况}\\
实根也可能在辅助方程中解得\\
局限性：无法判断含延迟环节e^{-\tau s}的系统稳定性\\
\ \\
特殊情况：\\
1. \ 0 (\varepsilon\rightarrow 0^+)继续计算，取极限判正负\\
 2. 全零行 \rightarrow 由上一行系数列写辅助函数P(s)，求导作为本行数值\\
辅助方程P(s)的解是原特征方程D(s)解的一部分$$

## 稳态误差定义

**哈工大默认输出端**

$$E_R(s)=\frac{1}{H(s)}[R(s)-B(s)]=\frac{1}{H(s)}R(s)\Phi_e(s)\quad （梅森公式不可用）$$
$$E_N(s)=-C_N(s)=-\frac{1}{H(s)}B_N(s)=-\frac{1}{H(s)}N(s)\Phi_{en}(s)即为扰动产生的误差$$

## 静态误差系数及稳态误差（单位反馈）

**稳态误差计算前提：先判断稳定性**

**静态误差系数法前提：无输入前馈**
$$开环传递函数：G(s)=\frac{K}{s^v}\frac{(\tau_1s+1)\cdots(\tau_m+1)}{(T_1s+1)\cdots(T_ns+1)}\\
\left\{\begin{array}{l}K为开环放大倍数\\ v为系统型别，即无静差度（定义不严格，根据可跟踪的信号即可判断型别）
\end{array}\right.$$

**直接用“静态误差系数”计算稳态误差即可**
$$通法：e_{ss}=\lim\limits_{s\to 0}s\cdot E(s)=\lim\limits_{s\to0}s\cdot R(s)\Phi_e(s)\\
\ \\
\begin{array}{ll}
静态误差系数：&稳态误差：\\
k_p=\lim\limits_{s\to0}G(s) &e_{ssp}=\frac{A}{1+k_p}&\lim\limits_{s\to0}\frac{A}{1+G(s)} \\

k_v=\lim\limits_{s\to0}sG(s) &e_{ssv} =\frac{A}{k_v}&\lim\limits_{s\to0}\frac{A}{sG(s)}\\

k_a=\lim\limits_{s\to0}s^2G(s)
&e_{ssa}=\frac{A}{k_a}&\lim\limits_{s\to0}\frac{A}{s^2G(s)}
\end{array}（A为相对于单位输入的系数）$$

**若非单位反馈**
$$e^*_{ss}=\lim\limits_{s\to 0}sE(s)=\lim\limits_{s\to 0}s\frac{1}{H(s)}R(s)\Phi_e(s)$$
$$注：
\Phi_e(s)=1-\Phi(s)（
典型框图下满足：单位负反馈，无前馈，输入无预置传函）$$

## 动态误差系数法

$$\Phi_e(s)=\frac{E(s)}{R(s)}=c_0+c_1s+c_2s^2+\cdots（s的升阶长除法：除数、被除数均升阶书写）\\
e(t)=c_0r(t)+c_1r'(t)+c_2r''(t)+\cdots$$
$$注：\Phi(s)在s=0邻域内展开，t\to \infty\\
稳态误差随时间的变换规律，即误差的稳态分量$$

## 有理因式的时域反变换

$$一次因式：\\
单根：留数法\\
重根：\mathscr{L^{-1}}\left[\frac{1}{(s+a)^{n+1}}\right]=e^{-at}\frac{t^n}{n!}$$
$$二次因式：\\
单复根：\\
\mathscr{L^{-1}}\left[\frac{s+a}{(s+a)^2+\omega^2}\right]=e^{-at}\cos\omega t\qquad
\mathscr{L^{-1}}\left[\frac{\omega}{(s+a)^2+\omega^2}\right]=e^{-at}\sin\omega t\\
\ \\
注：重复根不考查$$

## 非零初始条件下的系统响应

$$例：G(s)=\frac{2(s+2)}{(s+1)(s+4)}\quad c(0)=-1,\dot{c}(0)=0,r(t)=1\\
输入输出微分方程：\ddot{c}+5\dot{c}+4c=2\dot{r}+4r\\
非零初始条件下的拉氏变换：\\
\ [s^2C(s)-sc(0)-c'(0)]+5[sC(s)-c(0)]+4C(s)=\underbrace{2[sR(s)-r(0)]}_{r(0)=0}+4R(s)\\
s^2C(s)+5sC(s)+4C(s)=\underbrace{\frac{1}{s}(2s+4)}_{输入作用}\underbrace{-(s+5)}_{初始条件}\\
C(s)=\underbrace{\frac{-s-5}{s^2+5s+4}}_{C_0}+\underbrace{\frac{2s+4}{s(s^2+5s+4)}}_{C_r}\qquad（拉氏反变换）$$
$$注：输入在零时刻给到系统，故输入为零初始条件，c(0)=0,c'(0)=0;\quad r(0)=0\\
{\color{blue}（传递函数G(s)分母阶次决定输出零初始条件阶次，分子阶次决定输入初始条件阶次）}$$

## 由系统响应求传递函数

$$例1：系统单位阶跃响应为y(t)=1+e^{-t}+e^{-2t}，求系统传递函数\\
\ \\
判断响应为非零初始条件\quad y(0)=3,y'(0)=-3\\

设零初始条件下的y(t)=1+ae^{-t}+be^{-2t}（零初始与非零初始有相同的模态）\\
令\left\{\begin{array}{l}
y(0)=0\\
y'(0)=0
\end{array}\right.
解得
\left\{\begin{array}{l}
a=-2\\
b=1
\end{array}\right.\\
故Y(s)=\frac{1}{s}-\frac{2}{s+1}+\frac{1}{s+2}=\frac{2}{s(s+1)(s+2)}，即G(s)=\frac{2}{(s+1)(s+2)}$$
$$例2：单位阶跃响应为：c(t)=1-1.25e^{-3t}\sin(5t+53.1\degree)
=1-0.75e^{-3t}\sin5t-e^{-3t}\cos5t$$
$$注：单位脉冲响应等也应判断是否零初始条件$$

## 减小或消除稳态误差的方法

$$G(s)增大开环增益K：\\
列写\Phi_e(s)，判断稳态误差变化$$
$$G(s)增加串联积分环节（即提升系统型别v）：\\
列写\Phi_e(s)，判断稳态误差变化（提高系统型别，但会影响系统稳定性）$$
$$\star输入前馈控制（提高系统型别，不影响系统稳定性）：\\
\left\{\begin{array}{}
减小或消除输入信号下的稳态误差\\
减小或消除干扰输入下的稳态误差
\end{array}\right.\\
两种方法：\\1.配系数，使得\Phi_e(s)分子为零（一般G_b(s)实现可能有困难）\\
2.配系数，使得\Phi_e(s)分子阶次满足要求，即提升系统型别$$

## 劳斯判据的参数范围

$$系统稳定：满足劳斯稳定条件，解参数范围、关系$$
$$极点位于s=-a左侧：\\
令s=s^*-a，拆开后对s^*使用劳斯判据，求参数范围\\
注：g(s^*)=0缺项、存在正负系数，则参数不存在
$$

## 高阶系统主导极点性能分析

$$瞬态性能指一、二阶系统，若所给系统为高阶，利用主导极点分析\\
\Phi(s)=\frac{10}{(s+5)(s+4.56)(s+0.44)}=\frac{\frac{10}{5\times 4.56}}{(\frac{s}{5}+1)(\frac{s}{4.56}+1)(s+0.44)}\approx\frac{0.44}{s+0.44}
$$
$$注：稳态性能无分系统阶次，直接计算即可\\
主导极点两类情形\left\{\begin{array}{l}非主导极点实部>5倍的主导极点实部\\
偶极子相消（相近的零极点，两点之差小于模本身一个数量级）
\end{array}\right.$$

## 闭环稳定零、极点对系统性能影响

**不考虑调节时间**
$$零点：反应变快，\sigma\%\uparrow\quad t_p\downarrow；随着零点向虚轴靠近越加明显$$
$$极点：反应变慢， \sigma\%\downarrow\quad t_p\uparrow；随着极点向虚轴靠近越加明显$$

## 响应曲线反得系统参数典例

<div style="text-align: center;">
<img src="pic-principal-of-automation-control\Markji_1751374383156.png" width="80%">
</div>

$$\Phi(s)=\frac{K(s+a)}{s^v(Ts+1)+s+a}=\frac{K(s+a)}{Ts^{v+1}+s^v+s+a}\\
e(\infty)=0\Rightarrow v\geqslant1\\
系统稳定\Rightarrow v\leqslant2\\
c(\infty)=10\Rightarrow \lim\limits_{s\to0}s\cdot \frac{1}{s}\cdot\Phi(s)=10\Rightarrow K=10\\
c'(0)=10\Rightarrow \lim\limits_{t\to0}c'(t)=\lim\limits_{s\to\infty}s\cdot s\cdot\Phi(s)\frac{1}{s}=10\Rightarrow \lim\limits_{s\to\infty}\frac{Ks\cdot(s+a)}{Ts^{v+1}+s^v+s+a}=10\Rightarrow
\left\{\begin{array}{l}
v=1\\
\frac{K}{T}=10
\end{array}\right.$$
$$注：稳定性容易被忽略（特征多项式不缺项等）$$
