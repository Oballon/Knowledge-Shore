# 离散域

## 考情分析

模拟化校正不考，动态性能不考，动态误差系数法不考

**离散域的分析方法很匮乏**

## 离散域“延迟因子”标准型

$$G(z)=\frac{0.4z^{-1}(1+0.3z^{-1})}{(1-z^{-1})(1+0.5z^{-1})}\qquad(最小拍校正形式；便于获取零极点，负的z^{-1}系数即为零极点)$$
$$注：物理可实现系统(z的多项式n\geqslant m)$$

## 离散域基本概念

$$Z变换定义：E(z)=Z[e^*(t)]=E^*(s)|_{z=e^{Ts}}=\sum_{n=0}^{\infty}e(nT)z^{-n}$$

## 脉冲传递函数

$$零初始条件下，离散系统输出Z变换对输入Z变换之比$$

## 香农采样定理

$$\omega_s=\frac{2\pi}{T}=2\pi f\geqslant 2\omega_{\max}（连续信号频谱的上限频率）\\
\ \\
注：\omega_s为角频率，T为周期，f为频率$$

## 常见函数Z变换
$$\delta(t),\delta(t-kT), \ 1(t), \ t, \ \frac{t^2}{2}, \ a^{\frac{t}{T}}, \ e^{-aT}$$

$$\begin{array}{}
f(t)或f(k)& F(z)\\
\delta(t) & 1\\
\delta(t-kT) & z^{-k}\\
1(t) &\frac{1}{1-z^{-1}} & \frac{z}{z-1}\\
\ \\
t & \frac{Tz^{-1}}{(1-z^{-1})^2} & \frac{Tz}{(z-1)^2}\\
\ \\
\frac{t^2}{2} & \frac{T^2z^{-1}(1+z^{-1})}{2(1-z^{-1})^3} & \frac{T^2z(z+1)}{2(z-1)^3}\\
\ \\
a^{\frac{t}{T}},a^k & \frac{1}{1-az^{-1}} & \frac{z}{z-a}\\
\ \\
e^{-at},e^{-akT} & \frac{1}{1-e^{-aT}z^{-1}} & \frac{z}{z-e^{-aT}}
\end{array}$$
$$零阶保持器：Z\left[\frac{1-e^{-Ts}}{s}KG(s)\right]=K(1-z^{-1})Z\left[\frac{G(s)}{s}\right];\qquad
Z\left[\frac{1-e^{-Ts}}{s}e^{-Ts}G(s)\right]=z^{-1}(1-z^{-1})Z\left[\frac{G(s)}{s}\right]$$

## Z变换基本定理

**实质上是对连续信号离散后的信号进行Z变换**
$$线性性质：\\
Z[a\cdot e_1(t) +b \cdot e_2(t)] = aE_1(z)\pm bE_2(z)$$
$$实位移定理（延迟、超前）：\\
\left\{
\begin{array}{l}
Z[e(t-nT)]=Z^{-n}E(z) \\
Z[e(t+nT)]=Z^n[E(z)-\sum_{k=0}^{n-1}e(kT) \cdot z^{-k}]
\end{array}
\right.$$
$$复位移定理：\\
Z[e(t) \cdot e^{\mp at}]=E(z \cdot e^{\pm aT})$$
$$初值定理：\\
\lim\limits_{n\to 0}e(n)=\lim\limits_{z\to\infty}E(z)$$
$$终值定理：\\
\lim\limits_{n\to \infty}e(n)=\lim\limits_{z\to1}(z-1)E(z)$$

## Z变换

$$
部分分式法（通法）：F(s)展开为部分分式，常见函数Z变换对应$$
$${\color{grey}}\\
{\color{grey}留数法（单根）：
E[z]=\sum \text{Res}[E(s) \cdot \frac{z}{z-e^{Ts}}]\big|_{s=s_i}}
\\
{\color{grey}\text{Res}[E(s) \cdot \frac{z}{z-e^{Ts}}]=\lim\limits_{s\to s_i}[(s-s_i) \cdot E(s) \cdot \frac{z}{z-e^{Ts}}]}$$
$$注：含重根时，留数法可能存在理论问题\\
Z变换的计算考查不会很复杂，无须深究$$

## Z反变换

$$
部分分式法：\frac{X(z)}{z}展开成部分分式，分母的z乘至部分分式的分子位置\\
\ \\
注：Z反变换的通式计算考查很简单，一般只考纯单根\\
部分分式法通用性不强，适用单根，重根一般不易对应时域表达式\quad如\frac{T^2z(1+z)}{2(z-1)^3}\\
$$

$$长除法（无穷项）：z^{-1}的升阶长除法$$

## 离散稳定判定

$$1.特征根判定（二阶解根用韦达定理）：\\
解D(z)=0的根，单位圆内稳定；单位圆上临界稳定；单位圆外不稳定\\
2.劳斯判据:双线性变换：z=\frac{\omega+1}{\omega-1}代入D(z)，通分后分子为D^*(\omega)，对D^*(\omega)=0使用劳斯判据即可\\
3.朱利二阶系统判别，特征多项式D(z)=z^2+a_1z+a_0
\left\{
\begin{array}{}
|D(0)|=|a_0|<1\\
D(1)=1+a_1+a_0>0\\
D(-1)=1-a_1+a_0>0
\end{array}
\right.\\
4.\star\star含参数的离散根轨迹与单位圆的关系\star\star$$
$$注：离散稳定性与连续稳定性无必然联系\\
$$

## 离散域静态误差系数及稳态误差（单位反馈）

**稳态误差计算前提：先判断稳定性**

**直接用“静态误差系数”计算稳态误差即可**

$$通法：e_{ss}=\lim\limits_{z\to 1}(z-1)E(z)=\lim\limits_{z\to 1}(z-1)\cdot R(z)\cdot\Phi_e(z)\\
\ \\
\begin{array}{lll}
静态误差系数：&稳态误差：\\
k_p=\lim\limits_{z\to1}G(z)& e_p(\infty)=\frac{A}{1+k_p}&\frac{A}{1+\lim\limits_{z\to1}G(z)}\\

k_v=\lim\limits_{z\to1}(z-1)G(z)&e_v(\infty)=\frac{AT}{k_v}&\frac{AT}{\lim\limits_{z\to1}(z-1)G(z)}\\

k_a=\lim\limits_{z\to1}(z-1)^2G(z)&e_a(\infty)=\frac{AT^2}{k_a}&\frac{AT^2}{\lim\limits_{z\to1}(z-1)^2G(z)}
\end{array}$$
$$注：离散稳态误差用静态误差系数法一般不失效$$

## 离散域稳态误差

**稳态误差计算前提：先判断稳定性**

**用梅森增益公式求传函，“直连项”整体Z变换**
$$e_{ss}=e(\infty)=\lim\limits_{z\to 1}(z-1)E(z)=\lim\limits_{z\to 1}(z-1)\cdot \Phi_e(z)\cdot R(z)\\

e_{ss}=e(\infty)=\lim\limits_{z\to 1}(z-1)E(z)=\lim\limits_{z\to 1}(z-1)\cdot[R(z)-B(z)]\\

e_{ss}=e(\infty)=\lim\limits_{z\to 1}(z-1)E(z)=\lim\limits_{z\to 1}(z-1)\cdot[E_R(z)-E_N(z)]（输入+干扰）$$

## 离散输出与连续输出的关系

$$\begin{array}{ll}
连续\to 连续 & 连续\to 离散\\
离散\to 连续 & 离散\to 离散
\end{array}$$
$$理论上，离散输出与连续输出有本质区别：（较复杂，适当把握即可）\\
同一系统（连续或离散化），输入给定“符合”的连续与离散信号，其输出必然不同（激励不同，结果必然不同）\\
同一信号，给到连续或被离散化的系统（连续信号不被等效为离散），其输出也必然不同（单纯的输出离散化系统除外）$$
$${\color{blue}脉冲响应不变性}：由于脉冲信号本身可视为连续或离散，且只作用某一时刻；\\
同一系统（连续或离散化）在脉冲信号激励下，连续或离散化输出一致
$$
$${\color{blue}除脉冲响应外，其余响应的离散与连续基本不“符合”}$$
$$注：离散化的系统子环节仍为连续$$

## 求脉冲传递函数与离散输出

$$列写连续域表达式与传递函数
\left\{
\begin{array}{}
子环节间存在“直线”连通，则一起Z变换\\
子环节间无“直线”连通，则分开Z变换
\end{array}\right.$$
$$注：考研范围内，此法均适用，
但事实上存在失效情况\\
脉冲传递函数可能无法求，输入与内部之间无“开关”，或内部耦合无法相消
$$

<div style="text-align: center;">
<img src=pic-principal-of-automation-control\Markji_1751375002452.png width="50%">
</div>

$$列写C(s)表达式，按照“直连”原则改写即可\\
前馈与中间环节捆绑，导致脉冲传递函数不存在$$
<div style="text-align: center;">
<img src=pic-principal-of-automation-control\Markji_1751375019609.png width="50%">
</div>

$$脉冲传递函数典例：内部耦合无法相消，即失效情形$$

## 极点在z平面分布与瞬态响应的关系

$$重根情形较复杂，{\color{blue}定性理解即可}，考研不涉及计算$$

<div style="text-align: center;">
<img src=pic-principal-of-automation-control\Markji_1751375046666.png width="80%">
</div>

$$\left\{\begin{array}{l}
0<z<1的实根，衰减无振荡\\
-1<z<0的实根，衰减振荡\\
\\
z=1，等值不变\\
z=-1，等值振荡\\
|z|=1的复根，等幅振荡\\
\ \\
z>1的实根，发散无振荡\\
z<-1的实根，发散振荡\\
\ \\
|z|<1的复根，衰减振荡\\
|z|>1的复根，发散振荡\\

\end{array}\right.$$

## 离散域中的根轨迹

$$前提：脉冲传递函数存在\\
根据开环传递函数G(z)画根轨迹，根据极点与单位圆之间的关系判稳\\
$$
$$注：整理为关于z的多项式$$

## 最小拍校正

$$标准型：G(z)=\frac{0.4z^{-1}(1+0.3z^{-1})}{(1-z^{-1})(1+0.5z^{-1})}$$
$$\Phi(z)=\frac{D(z)G(z)}{1+D(z)G(z)}\quad 纯延迟因子，G(z)单位圆上、外的零点\\
\Phi_e(z)=\frac{1}{1+D(z)G(z)}\quad 输入分母（z^{-1}形式），G(z)单位圆上、外的极点\\
注：\Phi_e(z)的“极点因子”与“输入分母因子”{\color{blue}不应叠加}，取阶次高者即可$$
$${\color{blue}保证三条原则}：延迟因子，单位圆上、外的零极点，\Phi(z)与\Phi_e(z)为z^{-1}齐次\\
对应设z^{-1}的多项式，解未知系数
\left\{
\begin{array}{l}
\Phi(z)=az^{-1}(1+bz^{-1})\cdots\\
\Phi_e(z)=(1+z^{-1})(1+cz^{-1})\cdots
\end{array}
\right.\quad
 \Phi(z)=1-\Phi_e(z)解参数\\
整体思路：“灵活凑，满足三原则, 灵活设系数”\\
凑不出来设高阶,\quad a(1+z^{-1})(1+bz^{-1})\\
调整拍数取决于具体系统，不一定$$
$$反解校正传函：D(z)=\frac{\Phi(z)}{G(z)\Phi_e(z)}\quad $$
$$注：
最小拍校正需满足\Phi(z)=1-\Phi_e(z)，即无前馈，无输入传函，且单位负反馈；其它情形不考，难以使用
$$

## 无波纹系统

$$无波纹系统（样点间脉动）：采样点间的实际连续系统无波动\\
结论：判断\Phi(z)是否包含G_d(z)的全部零点，包含则无波纹；否则有波纹$$

## 离散系统的差分方程或输出

$$\Phi(z)=\frac{0.368z^{-1}+0.264z^{-1}}{1-z^{-1}+0.632z^{-1}}$$
$$差分方程：\\

C(z)=\Phi(z)\cdot R(z)=\frac{0.368z^{-1}+0.264z^{-2}}{1-z^{-1}+0.632z^{-2}}\cdot R(z)\\
(0.368z^{-1}+0.264z^{-2})R(z)=(1-z^{-1}+0.632z^{-2})C(z)\\
0.368r(n-1)+0.264r(n-2)=c(n)-c(n-1)+0.632c(n-2)$$
$$系统输出（差分方程代入，或长除法）：\\
C(z)=\Phi(z)\cdot R(z)=\frac{0.368z^{-1}+0.264z^{-2}}{1-z^{-1}+0.632z^{-2}}\cdot \frac{1}{(1-z^{-1})}\\
C(z)=0.368z^{-1}+z^{-2}+1.4z^{-3}+\cdots\\
c(t)=0.368\delta(t-T)+\delta(t-2T)+1.4\delta(t-3T)+\cdots$$

## 已知稳态误差反解参数范围

<div style="text-align: center;">
<img src=pic-principal-of-automation-control\Markji_1751375072618.png width="80%">
</div>

$$G(z)=Z[\frac{1-e^{-Ts}}{s}\times\frac{Ke^{-Ts}}{s}]=\frac{KT}{z(z-1)}\\

\left\{\begin{array}{ll}
K_p=\lim\limits_{z\to1}G(z)=\infty, & e_{ssp}=\frac{2}{1+K_p}=0\\

K_v=\lim\limits_{z\to 1}(z-1)G(z)=0.2K, & e_{ssv}=\frac{1}{K}
\end{array}\right.\\
\ \\
\left\{\begin{array}{l}
稳态误差：e_{ss}=e_{ssp}+e_{ssv}=\frac{1}{K}<0.25\\
\star 系统稳定：D(z)=z^2-z+0.2K=0
\end{array}\right.$$
$${\color{blue}注：连续系统同理，确保系统稳定}$$
