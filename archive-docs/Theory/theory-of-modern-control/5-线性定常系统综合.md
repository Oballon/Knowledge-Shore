# ""线性定常系统综合""

## 考情分析

系统解耦不考

## 三大线性反馈控制

$$系统\Sigma(A,B,C)，假设D=0$$
$$状态反馈控制律：u=Kx+v, \quad u=KX \qquad \Sigma_K((A+BK),B,C)$$
$$输出反馈控制律：u=Hy+v=HCx+v,\quad u=HCx\qquad
\Sigma_H((A+BHC),B,C)$$
$$输出到\dot{x}反馈：\dot{x}=Ax+Gy+Bu\qquad
\Sigma_G((A+GC),B,C)$$

$$注意区别：(A-BK)\quad (A-BHC)\quad (A-GC)\\
$$

## 极点配置的前提

$$定理一：状态反馈\Sigma(A+bK,b,c)对系统任意配置极点的充要条件：\Sigma(A,b,c)完全能控\\
\ \\
定理二：输出到\dot{x}的线性反馈\Sigma(A+Gc,b,c)对系统实现闭环极点任意配置的充要条件：\Sigma(A,b,c)完全能观$$

## 系统的极点配置

**离散极点配置同理**

**极点配置“基本”只考SISO系统**  
$$前提：判能控、能观，满足才可任意配置极点$$
$$
直接计算{\color{blue}（维数\leqslant3）}：比较系数即可\\
|\lambda I-(A+bK)|=f^*(\lambda)\quad状态反馈的极点配置\\
|\lambda I-(A+Gc)|=f^*(\lambda)\quad 输出到\dot{x}反馈的极点配置$$
$$能控标准I型、能观标准Ⅱ型计算{\color{blue}（应试用途不大）}：\\
线性变换x=T\overline{x}，化为能控标准I型、能观标准Ⅱ型\ \Sigma(\overline{A},\overline{b},\overline{c})\\
\left.\begin{array}{l}
|\lambda I-(\overline{A}+\overline{b}\ \overline{K})|=f^*(\lambda)\quad {\color{blue}最后一行}对应还原特征多项式系数\\
|\lambda I-(\overline{A}+\overline{G}\ \overline{c})|=f^*(\lambda)\quad {\color{blue}最后一列}对应还原特征多项式系数
\end{array}\right\}友矩阵不变形（理解原理）\\
谨记线性变换回原系数阵\left\{\begin{array}{}
 K=\overline{K}T_{c1}^{-1}\\
 G=T_{o2}\overline{G}
\end{array}\right.$$
$$注：K=(k_1,k_2,\cdots,k_n)\quad
G=(g_1,g_2,\cdots,g_n)^T$$

## 系统镇定

$$系统\Sigma(A,b,c)通过极点配置使其极点均具有负实部$$

## 状态观测器原理

$$系统极点的任意配置离不开全状态变量，但系统的状态变量不都是易于观测的\\
状态观测器构造出与系统等价的全状态可观测系统，用于提供系统状态$$

## 状态观测器的可实现性

$$定理：若线性系统\Sigma(A,b,c)完全能观，则其状态矢量x可由输出y与输入u进行重构$$

## 全维状态观测器方程

**全维观测器“基本”只考SISO系统**
$$存在前提：判定系统\Sigma(A,b,c)能观性\\
\ \\
类似输出到\dot{x}的反馈情形\\

\dot{\widehat{x}}=A\widehat{x}  +bu + G(y-\widehat{y})\\

\dot{\widehat{x}}=(A-Gc)\widehat{x}  +bu + Gy=\underbrace{A\widehat{x}+bu+G(y-\widehat{y})}_{结构图表达式}\\
对A-Gc配置极点，解出G：|\lambda I-(A-Gc)|=f^*(\lambda)，G代入状态观测器方程即可
$$
$$注：可构造能控、能观标准型\ 全维状态观测器，与降维状态观测器线性变换处理方式相似同理，考研不太会涉及$$

## 状态观测器的渐进速度

$$
G为状态观测器的输出误差反馈矩阵，影响系统的渐进速度\\
使\widehat{x}以一定速度与精度趋近于系统真实状态x\\
默认定义：\widetilde{x}=x-\widehat{x}\quad \widetilde{y}=y-\widehat{y}\\
\begin{array}{rl}
\dot{\widetilde{x}}&=\dot{x}-\dot{\widehat{x}}\\
&=Ax+Bu-[(A-GC)\widehat{x}+Gy+Bu]\\
&=Ax-(A-GC)\widehat{x}-GCx\\
&=(A-GC)(x-\widehat{x})\\
&=(A-GC)\tilde{x}
\end{array}\\
故\tilde{x}(t)=e^{(A-GC)t}\tilde{x}(0)$$

## 降维状态观测器标准型

$$\begin{array}{}\overline{y}=(0,I)\left(\begin{array}{}
\overline{x}_1\\
\overline{x}_2
\end{array}\right)=\overline{x}_2\\
\left\{\begin{array}{}
\dot{\widehat{\overline{w}}}=(\overline{A}_{11}-\overline{G}\  \overline{A}_{21})\widehat{\overline{x}}_1+(\overline{A}_{12}-\overline{G}\ \overline{A}_{22})\overline{y}\ +(\overline{B}_1-\overline{G}\ \overline{B}_2)u \quad （“上减\overline{G}下”）\\
\widehat{\overline{x}}_1=\widehat{\overline{w}} \ +\overline{G}\ \overline{y}
\end{array}\right.
&

\end{array}

$$
$$\begin{array}{}\overline{y}=(I,0)\left(\begin{array}{}
\overline{x}_1\\
\overline{x}_2
\end{array}\right)=\overline{x}_1\\
\left\{\begin{array}{}
\dot{\widehat{\overline{w}}}=(\overline{A}_{22}-\overline{G}\  \overline{A}_{12})\widehat{\overline{x}}_2+(\overline{A}_{21}-\overline{G}\ \overline{A}_{11})\overline{y}\ +(\overline{B}_2-\overline{G}\ \overline{B}_1)u\quad （“下减\overline{G}上”）\\
\widehat{\overline{x}}_2=\widehat{\overline{w}} \ +\overline{G}\ \overline{y}
\end{array}\right.
\end{array}$$

## 降维状态观测器方程

**降维状态观测器“基本”只考SISO系统**
$$存在前提：判定系统\Sigma(A,b,c)能观\\
\ \\化标准型（先判断是否为标准型）：\\
x=T\overline{x}，变换矩阵T，使\overline{y}=(0,I)\overline{x}\\
T^{-1}=
\left(\begin{array}{}
C_0\\
C
\end{array}\right)\quad C_0保证T可逆即可（考试中越简单越好，主对角）\\
\left(\begin{array}{}
\dot{\overline{x}}_1\\
\dot{\overline{x}}_2
\end{array}\right)=
\left(\begin{array}{}
\overline{A}_{11}&\overline{A}_{12}\\
\overline{A}_{21}&\overline{A}_{22}
\end{array}\right)
\left(\begin{array}{}
\overline{x}_1\\
\overline{x}_2
\end{array}\right)+
\left(\begin{array}{}
\overline{B}_1\\
\overline{B}_2
\end{array}\right)u
\\
\overline{y}=(0,I)\left(\begin{array}{}
\overline{x}_1\\
\overline{x}_2
\end{array}\right)=\overline{x}_2\qquad {\color{blue}（利用I的维数区分子系统\overline{A}_{ij}的维数）}$$
$$观测器方程：\left\{\begin{array}{}
\dot{\widehat{\overline{w}}}_1=(\overline{A}_{11}-\overline{G}\  \overline{A}_{21})\widehat{\overline{x}}_1+(\overline{A}_{12}-\overline{G}\ \overline{A}_{22})\overline{y}\ +(\overline{B}_1-\overline{G}\ \overline{B}_2)u\qquad \textcircled{1}\\
\widehat{\overline{x}}_1=\widehat{\overline{w}} \ +\overline{G}\ \overline{y}\qquad\textcircled{2}\\
\end{array}\right.\\

对矩阵(\overline{A}_{11}-\overline{G}\  \overline{A}_{21})进行极点配置：|\lambda I-(\overline{A}_{11}-\overline{G}\ \overline{A}_{21})|=f^*(\lambda)，解得\overline{G}

$$
$$\widehat{\overline{x}}=
\left(\begin{array}{}
\widehat{\overline{x}}_1\\
\widehat{\overline{x}}_2
\end{array}\right)=
\left(\begin{array}{}
\widehat{\overline{w}}+\overline{G}\overline{y}\\
\overline{y}
\end{array}\right)\\
状态估计方程：\widehat{x}=T\widehat{\overline{x}}=T\left(\begin{array}{}
\widehat{\overline{w}}+\overline{G}\overline{y}\\
\overline{y}
\end{array}\right)\\
画结构图时，已知系数，\textcircled{2}式代入\textcircled{1}式\\
先画\widehat{\overline{w}}的状态结构，再组合\widehat{\overline{w}},\overline{y}得\widehat{\overline{x}}，T变换得\widehat{x}$$
$$注：若系统为降维标准型，则无需进行T线性变换，运算时去掉\overline{\Delta}上的一杠符号\\
实际上\overline{y}=cT\overline{x}=cx=y$$

## 利用状态观测器实现状态反馈

$$前提：系统能控能观才可利用状态观测器进行状态反馈任意极点配置$$
$$受控系统\Sigma_0\left\{\begin{array}{l}
\dot{x}=Ax+bu\\
y=cx
\end{array}
\right.\qquad
 状态观测器\Sigma_G \left\{\begin{array}{c}
\dot{\widehat{x}}=(A-Gc)\widehat{x}+Gy+bu\\
\\
\dot{\widehat{x}}=A\widehat{x}  +bu + G(y-\widehat{y})
\end{array}
\right.\\
由于极点设计的分离性：|sI-\overline{A}|=|sI-(A+BK)||sI-(A-GC)|\\
观测器的极点、状态反馈的极点分开设计\\
\ \\
画结构图时，先绘制观测器（一般\dot{x}=Ax更方便），状态反馈最后从观测器状态变量引至输入即可
$$
$$注：
极点设计的分离性，全维、降维状态观测器均满足，无需深究\\（状态反馈在状态观测器上，而非原系统上）\\
绘制的增益G框，反馈K框等均只包含系数\\
\left\{\begin{array}{l}状态观测器特征值决定状态误差的衰减速度\\
系统特征值决定系统稳定的速度\\
\end{array}\right.（特征值仅决定衰减速度，不决定相关系数）
$$

## 极点配置典例

<div style="text-align: center;">
<img src=pic-theory-of-modern-control\Markji_1751378225556.png width="">
</div>

$$(1)\quad 写出状态空间表达式\\
(2)\quad 当所有状态变量都用于反馈时，确定合适的反馈增益，使得r(t)=1时，e_{ss}=0，且\sigma\%<3\%$$
$$(1)\quad \dot{x}=
\left(\begin{array}{}
0&1\\
0&-1
\end{array}\right)x
\qquad
b=
\left(\begin{array}{}
0\\
2
\end{array}\right)\\

\qquad\ y=
\left(\begin{array}{}
1&0
\end{array}\right)x$$
$$(2)\quad {\color{blue}题目有问题}：
e_{ss}=0转化为y_{ss}=1处理\\
f(\lambda)=|\lambda I-(A-bK)|=\lambda^2+(1+2k_2)\lambda+2k_1\\
\Phi(s)=c(sI-(A-bK))^{-1}b=\frac{2}{\lambda^2+(1+2k_2)\lambda+2k_1}\\

\left\{\begin{array}{l}
y_{ss}=\lim\limits_{s\to 0}s\cdot \Phi(s)\cdot R(s)=\frac{1}{k_1}=1\Rightarrow k_1=1\\

\sigma\%<3\%\Rightarrow \xi>0.745\Rightarrow \frac{1+2k_2}{2\sqrt{2}}>0.745\Rightarrow k_2>0.553
\end{array}\right.$$
$$两个方向
\left\{\begin{array}{l}
条件直接给出闭环极点\\
待定系数配置极点，系统特征反解参数

\end{array}\right.$$

## 非线性方程的空间表达式

<div style="text-align: center;">
<img src=pic-theory-of-modern-control\Markji_1751378241527.png width="60%">
<img src=pic-theory-of-modern-control\Markji_1751378255854.png width="60%">
</div>

$$令\left\{\begin{array}{}
x_1=x\\
x_2=\dot{x}
\end{array}\right.
则系统状态方程为
\left\{\begin{array}{l}
\dot{x}_1=x_2\\
\dot{x}_2=-x_1^2-x_2+1
\end{array}\right.\\
\ \\
求平衡点，平衡点处线性化判稳$$
